import{arrayify as t,hexlify as e}from"@ethersproject/bytes";import{computeHmac as r}from"@ethersproject/sha2";"use strict";function pbkdf2(n,l,o,s,c){n=t(n);l=t(l);let h;let i=1;const f=new Uint8Array(s);const p=new Uint8Array(l.length+4);p.set(l);let g;let a;for(let e=1;e<=i;e++){p[l.length]=e>>24&255;p[l.length+1]=e>>16&255;p[l.length+2]=e>>8&255;p[l.length+3]=255&e;let m=t(r(c,n,p));if(!h){h=m.length;a=new Uint8Array(h);i=Math.ceil(s/h);g=s-(i-1)*h}a.set(m);for(let e=1;e<o;e++){m=t(r(c,n,m));for(let t=0;t<h;t++)a[t]^=m[t]}const y=(e-1)*h;const b=e===i?g:h;f.set(t(a).slice(0,b),y)}return e(f)}export{pbkdf2};

